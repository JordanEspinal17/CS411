<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CS411 Login</title>
    
    <link rel="stylesheet" href="style.css">

    <link href='https://unpkg.com/boxicons@2.1.2/css/boxicons.min.css' rel='stylesheet'>
    
</head>
<body>
    <section class="container forms">
        <div class="form login">
            <div class="authForm">
            
                <header>Login</header>
                <!--Put an action of where to take login page here-->
                    <div class="field input-field">
                        <input type="email" placeholder="email" id="userEmail" class="input">
                    </div>

                    <div class="field input-field">
                        <input type="password" placeholder="password" id="userPassword" class="password">
                        <!-- i class='bx bx-hide eye-icon'></i>-->
                        <!-- put out of comment when ready to use-->
                    </div>

                    <!-- put a forgot password here?-->

                    <div class="field button-field">
                        <button id="signInButton">Sign In</button>
                    </div>

                    <div class="field button-field">
                        <button id="signUpButton">Sign Up</button>
                    </div>

                <!-- dont have an account area and send to a sign up page-->

            </div>
        </div>
        

        <div class="containerTesting">
            <button id="signInButton">Sign In</button>
            <input type="checkbox" checked="checked"> Remember me   
            Forgot <a href="#"> password? </a> 
        </div>

    </section>

    <script type="module">
        //Update the below URL with the appropriate version if necessary.
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js";
        import {
            getAuth,
            createUserWithEmailAndPassword,
            signInWithEmailAndPassword,
            onAuthStateChanged,
            signOut
        //Update the below URL with the appropriate version if necessary.
        } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-auth.js";
       
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-analytics.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries

        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
            apiKey: "AIzaSyBtkFbG_FmHlxbyWDApj-4EbUnrC_lUBa0",
            authDomain: "cs411-6f937.firebaseapp.com",
            projectId: "cs411-6f937",
            storageBucket: "cs411-6f937.appspot.com",
            messagingSenderId: "6897657236",
            appId: "1:6897657236:web:6a012f74b1aca6002a1b81",
            measurementId: "G-M6EEKTE7RV"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        const userEmail = document.querySelector("#userEmail");
        const userPassword = document.querySelector("#userPassword");
        const authForm = document.querySelector("#authForm");
        const secretContent = document.querySelector("#secretContent");
        const signUpButton = document.querySelector("#signUpButton");
        const signInButton = document.querySelector("#signInButton");
        const signOutButton = document.querySelector("#signOutButton");

        secretContent.style.display = 'none';

        const userSignUp = async() => {
            const signUpEmail = userEmail.value;
            const signUpPassword = userPassword.value;
            createUserWithEmailAndPassword(auth, signUpEmail, signUpPassword)
            .then((userCredential) => {
                const user = userCredential.user;
                console.log(user);
                alert("Your account has been created!");
            })
            .catch((error) => {
                const errorCode = error.code;
                const errorMessage = error.message;
                console.log(errorCode + errorMessage)
                alert(errorCode + errorMessage)
            })
        }

        const userSignIn = async() => {
            const signInEmail = userEmail.value;
            const signInPassword = userPassword.value;
            signInWithEmailAndPassword(auth, signInEmail, signInPassword)
            .then((userCredential) => {
                const user = userCredential.user;
                alert("You have signed in successfully!");
            })
            .catch((error) => {
                const errorCode = error.code;
                const errorMessage = error.message;
                console.log(errorCode + " " + errorMessage)
                alert(errorCode + errorMessage)
            })
        }

        <button id="checkAuthButton">Check Authorization</button>
        document.getElementById('checkAuthButton').addEventListener('click', checkAuthState);

        const checkAuthState = async() => {
            const user = await new Promise((resolve) =>  {
                const unsubscribe = onAuthStateChanged(auth, (user) => {
                    unsubscribe()
                    resolve(user)
                });
            });

            if(user) {
                window.location.href = 'secret.html';
            } else {
                console.log("Auth failed");
            }
        }

        const userSignOut = async() => {
            await signOut(auth);
        }

        checkAuthState();

        signUpButton.addEventListener('click', userSignUp);
        signInButton.addEventListener('click', userSignIn);
        signOutButton.addEventListener('click', userSignOut);
      </script>
</body>
</html>